# Naiguru Insights

ダーツの練習記録を効率化し、AIによる分析を可能にするLINEボットシステムです。

## システム概要

Naiguru Insightsは、Google Apps Script (GAS) を基盤としたダーツ練習支援システムです。LINE Messaging APIを通じてユーザーと対話し、日々の練習内容をGoogleスプレッドシートに自動的に記録します。また、Gemini AIを活用して、練習の振り返り内容に基づいたアドバイスや要約を生成します。

### 主な機能
- **練習開始/終了管理**: 「練習開始」「振り返り開始」というキーワードでセッションを管理。
- **目標設定**: 練習開始時に今日の目標を記録。前回の振り返り内容を自動的に提示し、継続的な改善を促します。
- **スタッツ記録（対話型）**: BULL数、LowTon数、プレイ時間などの数値を1項目ずつ対話形式で入力・保存。ハイフン `-` による入力スキップにも対応。
- **プレイ時間入力**: `hh:mm` 形式（例：1:30）での時間入力に対応。
- **AI分析**: セッション終了後、Gemini APIを用いて練習内容を要約し、次回の練習に活かせるフィードバックを提供。
- **リマインド機能**: 練習開始後、一定時間経過しても振り返りがない場合にLINEで通知。
- **堅牢な排他制御**: ロック機能の導入により、メッセージの連投によるデータの誤上書きを防止。

### 技術スタック
- **Language**: Google Apps Script (JavaScript)
- **Database**: Google Sheets
- **External APIs**: LINE Messaging API, Gemini API (Google AI SDK)
- **Deployment**: clasp (Command Line Apps Script Projects)
- **Concurrency Control**: GAS LockService (User Lock)

## 構成
- `Scripts/`: システムの本体となるGASソースコード
- `Documents/`: 運用フローや開発者向けの手順書

## バージョン履歴

### v1.6.1 (2026-02-14) **Latest Release**
- **排他制御の導入**: `LockService` を用いたロック機能を実装。連投による振り返り文章の誤上書き問題を解決。
- **時間形式入力への対応**: DARTSLIVEプレイ時間を `hh:mm` 形式で入力可能に改善。
- **ロジックの堅牢化**: ステータスと実データの有無の両方を確認する確実な判定フローへ刷新。

### v1.6.0 (2026-02-14)
- **対話型数値入力機能**: BULL数、LowTon数、Range、プレイ時間を一つずつ順番に質問するフローを実装。
- **設定の動的化**: `config.gs` の定義を増やすだけで項目追加が可能な仕組みを導入。

### v1.5.0 (2026-02-14)
- **ドキュメントの整備**: `add_new_metric.md` (項目追加手順書) および `line_flow_guide.md` (運用ガイド) を作成。

### v1.4.0 (2026-02-14)
- リマインド機能 (`checkAndSendReminders`) の復元と最適化。
- ログ出力機能の強化とプッシュメッセージ送信機能の追加。

### v1.3.0 (2026-02-14)
- コード可読性向上のためのコメント拡充 (`gemini.gs`, `main.gs`)。

### v1.2.0 (2026-02-14)
- 開発環境への `clasp` 導入と構成管理の開始。

### v1.0.0 (2026-02-14)
- LINEボットを通じた練習記録とGemini AIによる解析機能の初期リリース。
